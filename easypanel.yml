# Easypanel project configuration
project:
  name: agendaai
  services:
    app:
      # Build settings
      dockerfile: Dockerfile
      port: 3000
      env:
        - name: NODE_ENV
          value: production
        - name: PORT
          value: "3000"
        - name: HOSTNAME
          value: "0.0.0.0"
        - name: NEXT_TELEMETRY_DISABLED
          value: "1"
        - name: PRISMA_CLIENT_ENGINE_TYPE
          value: binary
        # Substitua pelas suas próprias variáveis de ambiente
        - name: DATABASE_URL
          value: "postgresql://{{dbuser}}:{{dbpass}}@{{dbhost}}:{{dbport}}/{{dbname}}?schema=public"
        - name: NEXTAUTH_URL
          value: "https://{{domain}}"
        - name: NEXTAUTH_SECRET
          secret: nextauth-secret

      # Resources
      resources:
        cpu: 1
        memory: 1024

      # Healthcheck
      healthcheck:
        path: /
        port: 3000
        initialDelaySeconds: 30
        periodSeconds: 30
        timeoutSeconds: 10
        successThreshold: 1
        failureThreshold: 3

      # Persistent volumes
      volumes: []

      # Database dependency
      depends_on:
        - db

    # PostgreSQL database
    db:
      image: postgres:15-alpine
      port: 5432
      env:
        - name: POSTGRES_USER
          value: "postgres"
        - name: POSTGRES_PASSWORD
          secret: postgres-password
        - name: POSTGRES_DB
          value: "agendaai"
      volumes:
        - name: postgres-data
          mountPath: /var/lib/postgresql/data
      resources:
        cpu: 0.5
        memory: 512
